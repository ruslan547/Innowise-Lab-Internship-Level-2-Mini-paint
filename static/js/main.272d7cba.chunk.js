(this["webpackJsonpinnowise-lab-internship-level-2-mini-paint"]=this["webpackJsonpinnowise-lab-internship-level-2-mini-paint"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a,r=n(19),c=n.n(r),i=n(6),s=(n(44),n(45),n(24)),o=n(3),u=n(34);!function(e){e.SIGNIN="/signin",e.REGISTER="/register",e.GALLERY="/",e.PAINT="/paint"}(a||(a={}));var l=n(2);var b=Object(i.b)((function(e){return{user:e.authReducer.user}}))((function(e){var t=e.user,n=e.component,r=Object(u.a)(e,["user","component"]);return Object(l.jsx)(s.b,Object(o.a)(Object(o.a)({},r),{},{render:function(e){return t?Object(l.jsx)(n,Object(o.a)({},e)):Object(l.jsx)(s.a,{to:a.SIGNIN})}}))})),j=n(9),d=(n(48),n(1)),O=n.n(d);n(49);function f(e){var t=e.onSubmit,n=e.onChange,a=e.children;return Object(l.jsxs)("form",{className:"form",onSubmit:t,children:[Object(l.jsx)("input",{className:"form__email",type:"email",name:"email",placeholder:"email",onChange:n,required:!0}),Object(l.jsx)("input",{className:"form__password",type:"password",name:"password",placeholder:"password",onChange:n,required:!0}),a]})}var m=O.a.memo(f);n(50);function h(e){var t=e.value;return Object(l.jsx)("input",{className:"form-btn",type:"submit",value:t})}var p=O.a.memo(h);n(51);function v(e){var t=e.value,n=e.onClick;return Object(l.jsx)("button",{className:"modal-btn",onClick:n,children:t})}var S=O.a.memo(v);n(52);function E(e){var t=e.children,n=e.text,a=e.value,r=e.onClick;return Object(l.jsxs)("div",{className:"modal",children:[t,Object(l.jsxs)("div",{className:"modal__footer",children:[Object(l.jsx)("span",{className:"modal__text",children:n}),Object(l.jsx)(S,{value:a,onClick:r})]})]})}var g,x=O.a.memo(E);!function(e){e.SIGNOUT="SIGNOUT",e.SUCCESS="SUCCESS",e.SET_CURRENT_USER_ID="SET_CURRENT_USER_ID"}(g||(g={}));var C=n(14),T=Object(C.a)(),R=n(32),_=(n(53),n(55),R.a.initializeApp({apiKey:"AIzaSyCAwELykffctQvVVslcPPXxa6gCbKD5znU",authDomain:"mini-paint-58a48.firebaseapp.com",databaseURL:"https://mini-paint-58a48-default-rtdb.firebaseio.com",projectId:"mini-paint-58a48",storageBucket:"mini-paint-58a48.appspot.com",messagingSenderId:"394339851119",appId:"1:394339851119:web:1dd455169d2dcde511269a"})),I=_.database(),N=_.auth(),w={signin:function(e,t){return N.signInWithEmailAndPassword(e,t)},register:function(e,t){return N.createUserWithEmailAndPassword(e,t)},signout:function(){return N.signOut()}};var A=n(7),y=n(10),L=n.n(y),P=n(17),k={sendImg:function(e,t){return D.apply(this,arguments)},onImages:function(){return U.apply(this,arguments)},onUsers:function(){return new Promise((function(e){I.ref().child("users").on("value",(function(t){var n=t.val();e(n||{})}))}))},setUserEmail:function(e,t){I.ref("users/".concat(e)).set({email:t.email})}};function D(){return(D=Object(P.a)(L.a.mark((function e(t,n){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.ref().child("images").push({image:t,uid:n});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=Object(P.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){I.ref().child("images").on("value",(function(t){var n=t.val();e(n||{})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B,G={signin:function(e,t){return function(n){w.signin(e,t).then((function(e){var t=e.user;if(t){var r=t.uid,c=t.email;n(H({email:c||"unknowk"})),n(z(r)),T.push(a.GALLERY)}})).catch((function(e){var t=e.message;A.b.isActive(B)||(B=A.b.error(t,{position:A.b.POSITION.TOP_CENTER}))}))}},register:function(e,t){return function(n){w.register(e,t).then((function(e){var t=e.user;if(t){var r=t.uid,c={email:t.email||"unknowk"};n(H(c)),n(z(r)),k.setUserEmail(r,c),T.push(a.GALLERY)}})).catch((function(e){var t=e.message;A.b.isActive(B)||(B=A.b.error(t,{position:A.b.POSITION.TOP_CENTER}))}))}},signout:function(){return function(e){w.signout().then((function(){e({type:g.SIGNOUT})}))}},success:H,setCurrentUserId:z};function H(e){return{type:g.SUCCESS,payload:e}}function z(e){return{type:g.SET_CURRENT_USER_ID,payload:e}}A.b.configure();n(59);function M(){var e=Object(d.useState)(""),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(d.useState)(""),s=Object(j.a)(c,2),o=s[0],u=s[1],b=Object(i.c)(),O=Object(d.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;"email"===n?r(a):"password"===n&&u(a)}),[]),f=Object(d.useCallback)((function(e){e.preventDefault(),b(G.signin(n,o))}),[n,o,b]),h=Object(d.useCallback)((function(){T.push(a.REGISTER)}),[]);return Object(l.jsxs)("div",{className:"signin",children:[Object(l.jsx)(A.a,{}),Object(l.jsx)(x,{text:"Need an account?",value:"register",onClick:h,children:Object(l.jsx)(m,{onChange:O,onSubmit:f,children:Object(l.jsx)(p,{value:"sign in"})})})]})}A.b.configure();var W=O.a.memo(M);n(60);function X(){var e=Object(d.useState)(""),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(d.useState)(""),s=Object(j.a)(c,2),o=s[0],u=s[1],b=Object(d.useState)(""),O=Object(j.a)(b,2),f=O[0],h=O[1],v=Object(d.useRef)(""),S=Object(i.c)(),E=Object(d.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;"email"===n?r(a):"password"===n?u(a):"confirmation"===n&&h(a)}),[]),g=Object(d.useCallback)((function(e){e.preventDefault(),o===f?S(G.register(n,o)):A.b.isActive(v.current)||A.b.error("Passwords do not match",{position:A.b.POSITION.TOP_CENTER})}),[n,o,f,S]);return Object(l.jsxs)("div",{className:"register",children:[Object(l.jsx)(A.a,{}),Object(l.jsx)(x,{text:"Already have an account?",value:"sign in",onClick:function(){T.push(a.SIGNIN)},children:Object(l.jsxs)(m,{onChange:E,onSubmit:g,children:[Object(l.jsx)("input",{className:"confirmation",type:"password",name:"confirmation",placeholder:"confirm password",onChange:E}),Object(l.jsx)(p,{value:"register"})]})})]})}A.b.configure();var Z=O.a.memo(X);n(61),n(62);function Y(e){var t=e.tool,n=e.isShowedSizeBar,a=e.name,r=e.children,c=e.isShowedShapeBar,i=e.onClick,s=Object(d.useMemo)((function(){var e="paint-btn";return(a===t||"size-bar"===a&&n||"shape-bar"===a&&c)&&(e+=" active"),e}),[a,t,c,n]);return Object(l.jsx)("button",{type:"button",className:s,name:a,onClick:i,children:r})}var K=Object(i.b)((function(e){var t=e.drawReducer;return{tool:t.tool,isShowedSizeBar:t.isShowedSizeBar,isShowedShapeBar:t.isShowedShapeBar}}))(O.a.memo(Y)),F=(n(63),n.p+"static/media/picture.082f3262.svg"),q=n.p+"static/media/logout.58dee8cf.svg";function J(){var e=Object(i.c)(),t=Object(d.useCallback)((function(){e(G.signout())}),[e]);return Object(l.jsx)(K,{onClick:t,children:Object(l.jsx)("img",{src:q,alt:""})})}var V,Q=O.a.memo(J);!function(e){e.NO_TOOL="NO_TOOL",e.PAINTBRUSH="PAINTBRUSH",e.LINE="LINE",e.RECTANGLE="RECTANGLE",e.CIRCLE="CIRCLE",e.STAR="STAR",e.HEXAGON="HEXAGON",e.START_DRAW="STARTDRAW",e.STOP_DRAW="STOP_DRAW",e.SET_COLOR="SET_COLOR",e.SHOW_SIZE_BAR="SHOW_SIZE_BAR",e.HIDE_SIZE_BAR="HIDE_SIZE_BAR",e.SET_SIZE="SET_SIZE",e.SHOW_SHAPE_BAR="SHOW_SHAPE_BAR",e.HIDE_SHAPE_BAR="HIDE_SHAPE_BAR",e.SET_IMG="SET_IMG",e.DELETE_IMG="DELETE_IMG",e.SET_CONTEXT="SET_CONTEXT",e.CLEAR="CLEAR"}(V||(V={}));var $={noTool:function(){return{type:V.NO_TOOL}},paintbrush:function(){return{type:V.PAINTBRUSH}},startDraw:function(){return{type:V.START_DRAW}},stopDraw:function(){return{type:V.STOP_DRAW}},setColor:function(e){return{type:V.SET_COLOR,payload:e}},showSizeBar:function(){return{type:V.SHOW_SIZE_BAR}},hideSizeBar:function(){return{type:V.HIDE_SIZE_BAR}},setSize:function(e){return{type:V.SET_SIZE,payload:e}},showShapeBar:function(){return{type:V.SHOW_SHAPE_BAR}},hideShapeBar:function(){return{type:V.HIDE_SHAPE_BAR}},line:function(){return{type:V.LINE}},rectangle:function(){return{type:V.RECTANGLE}},circle:function(){return{type:V.CIRCLE}},star:function(){return{type:V.STAR}},hexagon:function(){return{type:V.HEXAGON}},setImg:function(e){return{type:V.SET_IMG,payload:e}},deleteImg:function(){return{type:V.DELETE_IMG}},setContext:function(e){return{type:V.SET_CONTEXT,payload:e}},clear:function(){return{type:V.CLEAR}}};function ee(e){var t=e.dispatch,n=(e.img,Object(d.useCallback)(Object(P.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t($.deleteImg()),t($.clear()),T.push(a.GALLERY);case 3:case"end":return e.stop()}}),e)}))),[t]));return Object(l.jsxs)("ul",{className:"navbar",children:[Object(l.jsx)("li",{className:"navbar__item",children:Object(l.jsx)(Q,{})}),Object(l.jsx)("li",{className:"navbar__item",children:Object(l.jsx)(K,{onClick:n,children:Object(l.jsx)("img",{src:F,alt:""})})})]})}var te=Object(i.b)((function(e){var t=e.drawReducer,n=t.img;return{dispatch:t.dispatch,img:n}}))(O.a.memo(ee));n(64);function ne(e){var t=e.dispatch,n=e.color;return Object(l.jsx)("input",{className:"color-input",value:n,type:"color",name:"color",onChange:function(e){var n=e.target.value;t($.setColor(n))}})}var ae=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,color:t.color}}))(O.a.memo(ne)),re=n.p+"static/media/pencil.d161d2e9.svg";function ce(e){var t=e.dispatch,n=e.tool,a=Object(d.useCallback)((function(){n===V.PAINTBRUSH?t($.noTool()):t($.paintbrush())}),[t,n]);return Object(l.jsx)(K,{name:V.PAINTBRUSH,onClick:a,children:Object(l.jsx)("img",{src:re,alt:""})})}var ie=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(ce)),se=n.p+"static/media/circle.dddf140d.svg";function oe(e){var t=e.dispatch,n=e.tool,a=Object(d.useCallback)((function(){n===V.CIRCLE?t($.noTool()):t($.circle())}),[n,t]);return Object(l.jsx)(K,{name:V.CIRCLE,onClick:a,children:Object(l.jsx)("img",{src:se,alt:"circle"})})}var ue=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(oe)),le=n.p+"static/media/line.71e38afd.svg";function be(e){var t=e.dispatch,n=e.tool,a=Object(d.useCallback)((function(){n===V.LINE?t($.noTool()):t($.line())}),[n,t]);return Object(l.jsx)(K,{name:V.LINE,onClick:a,children:Object(l.jsx)("img",{src:le,alt:"line"})})}var je=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(be)),de=n.p+"static/media/hexagon.5fee026a.svg";function Oe(e){var t=e.dispatch,n=e.tool,a=Object(d.useCallback)((function(){n===V.HEXAGON?t($.noTool()):t($.hexagon())}),[n,t]);return Object(l.jsx)(K,{name:V.HEXAGON,onClick:a,children:Object(l.jsx)("img",{src:de,alt:"hexagon"})})}var fe=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(Oe)),me=n.p+"static/media/rectangle.19aa566b.svg";function he(e){var t=e.dispatch,n=e.tool,a=Object(d.useCallback)((function(){n===V.RECTANGLE?t($.noTool()):t($.rectangle())}),[n,t]);return Object(l.jsx)(K,{name:V.RECTANGLE,onClick:a,children:Object(l.jsx)("img",{src:me,alt:"rectangle"})})}var pe=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(he)),ve=n.p+"static/media/star.103f4316.svg";function Se(e){var t=e.dispatch,n=e.tool,a=Object(d.useCallback)((function(){n===V.STAR?t($.noTool()):t($.star())}),[n,t]);return Object(l.jsx)(K,{name:V.STAR,onClick:a,children:Object(l.jsx)("img",{src:ve,alt:"star"})})}var Ee=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(Se)),ge=(n(65),n.p+"static/media/points.ce4d7f60.svg");var xe=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,isShowedShapeBar:t.isShowedShapeBar}}))((function(e){var t=e.dispatch,n=e.isShowedShapeBar,a=Object(d.useCallback)((function(){t(n?$.hideShapeBar():$.showShapeBar())}),[n,t]);return Object(l.jsxs)("div",{className:"shape-bar",children:[Object(l.jsx)(K,{name:"shape-bar",onClick:a,children:Object(l.jsx)("img",{src:ge,alt:""})}),n&&Object(l.jsxs)("ul",{className:"shape-bar__setting",children:[Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(je,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(ue,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(pe,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(Ee,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(fe,{})})]})]})}));n(66);var Ce=Object(i.b)((function(e){var t=e.drawReducer;return{isShowedSizeBar:t.isShowedSizeBar,size:t.size,dispatch:t.dispatch}}))((function(e){var t=e.isShowedSizeBar,n=e.size,a=e.dispatch,r=Object(d.useCallback)((function(){a(t?$.hideSizeBar():$.showSizeBar())}),[t,a]);return Object(l.jsxs)("div",{className:"size-bar",children:[Object(l.jsx)(K,{name:"size-bar",onClick:r,children:"size"}),t&&Object(l.jsxs)("div",{className:"size-bar__setting",children:[Object(l.jsx)("input",{type:"range",name:"range",min:"1",max:"50",value:n,onChange:function(e){var t=e.target.value;a($.setSize(t))}}),Object(l.jsx)("span",{children:n})]})]})}));n(67);function Te(){return Object(l.jsxs)("ul",{className:"drawbar",children:[Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(ie,{})}),Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(xe,{})}),Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(Ce,{})}),Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(ae,{})})]})}var Re,_e=O.a.memo(Te),Ie=n.p+"static/media/disk.4e36d248.svg";function Ne(e){var t=e.img,n=e.isClean,a=e.currentUserId,r=Object(d.useRef)(""),c=Object(d.useCallback)(Object(P.a)(L.a.mark((function e(){var c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}A.b.isActive(Re)||(Re=A.b.error("Error: the template is clean",{position:A.b.POSITION.TOP_CENTER})),e.next=19;break;case 4:if(r.current!==t.src){e.next=8;break}A.b.isActive(Re)||(Re=A.b.error("Error: this image is already saved",{position:A.b.POSITION.TOP_CENTER})),e.next=19;break;case 8:return e.prev=8,console.log(a),e.next=12,k.sendImg(t.src,a);case 12:A.b.info("image saved",{position:A.b.POSITION.TOP_CENTER}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(8),c=e.t0.message,A.b.error(c,{position:A.b.POSITION.TOP_CENTER});case 19:r.current=t.src;case 20:case"end":return e.stop()}}),e,null,[[8,15]])}))),[n,t,a]);return Object(l.jsxs)("div",{children:[Object(l.jsx)(A.a,{}),Object(l.jsx)(K,{onClick:c,children:Object(l.jsx)("img",{src:Ie,alt:""})})]})}A.b.configure();var we=Object(i.b)((function(e){var t=e.drawReducer;return{img:t.img,isClean:t.isClean,currentUserId:e.authReducer.currentUserId}}))(O.a.memo(Ne)),Ae=[],ye={redraw:Le,addPoint:Pe,clearFromPaintbrush:function(){Ae.splice(0,Ae.length)},clearCanvas:ke,drawPoint:function(e,t,n,a,r,c){Pe(t,n,!0,a,r),Le(e),De(e,c)},drawLine:function(e,t,n,a,r,c,i,s){Le(e),e.lineWidth=+t,e.strokeStyle=n,e.beginPath(),e.moveTo(a,r),e.lineTo(c,i),e.closePath(),e.stroke(),De(e,s)},drawCircle:function(e,t,n,a,r,c,i){var s=.5522848,o=a/2*s,u=r/2*s,l=t+a,b=n+r,j=t+a/2,d=n+r/2;Le(e),e.fillStyle=c,e.beginPath(),e.moveTo(t,d),e.bezierCurveTo(t,d-u,j-o,n,j,n),e.bezierCurveTo(j+o,n,l,d-u,l,d),e.bezierCurveTo(l,d+u,j+o,b,j,b),e.bezierCurveTo(j-o,b,t,d+u,t,d),e.closePath(),e.fill(),De(e,i)},drawRectangle:function(e,t,n,a,r,c,i){Le(e),e.fillStyle=c,e.beginPath(),e.fillRect(t,n,a,r),e.closePath(),De(e,i)},drawImage:De,createImg:function(e){var t=e.toDataURL("image/png"),n=new Image;return n.src=t,n},drawStar:function(e,t,n,a,r,c){var i=Math.PI/5,s=Math.PI/2*3,o=t,u=n;Le(e),e.fillStyle=r,e.beginPath(),e.moveTo(t,n-a),new Array(5).fill(null).forEach((function(){o=t+Math.cos(s)*a,u=n+Math.sin(s)*a,e.lineTo(o,u),s+=i,o=t+Math.cos(s)*(a/2),u=n+Math.sin(s)*(a/2),e.lineTo(o,u),s+=i})),e.lineTo(t,n-a),e.closePath(),e.fill(),De(e,c)},drawHexagon:function(e,t,n,a,r,c){var i=.523598776,s=Math.sin(i)*a,o=Math.cos(i)*a,u=2*o,l=a+2*s;Le(e),e.fillStyle=r,e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+u,n+s),e.lineTo(t+u,n+s+a),e.lineTo(t+o,n+l),e.lineTo(t,n+a+s),e.lineTo(t,n+s),e.closePath(),e.fill(),De(e,c)},createContext:function(e){var t=e.getContext("2d");t&&(t.globalCompositeOperation="destination-over");return t}};function Le(e){ke(e),e.lineJoin="round",Ae.forEach((function(t,n,a){e.beginPath(),t.drag&&n?e.moveTo(a[n-1].pointX,a[n-1].pointY):e.moveTo(t.pointX-1,t.pointY),e.lineTo(t.pointX,t.pointY),e.closePath(),e.strokeStyle=t.color,e.lineWidth=+t.size,e.stroke()}))}function Pe(e,t,n,a,r){Ae.push({pointX:e,pointY:t,drag:n,color:a,size:r})}function ke(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}function De(e,t){t&&e.drawImage(t,0,0)}n(68);var Ue=n.p+"static/media/trash.2d44fa45.svg";function Be(e){var t=e.context,n=e.dispatch,a=Object(d.useCallback)((function(){n($.deleteImg()),t&&(ye.clearCanvas(t),n($.clear()))}),[n,t]);return Object(l.jsxs)("div",{className:"paint-toolbar",children:[Object(l.jsx)(te,{}),Object(l.jsx)(_e,{}),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{className:"clear-btn",children:Object(l.jsx)(K,{onClick:a,children:Object(l.jsx)("img",{src:Ue,alt:""})})}),Object(l.jsx)(we,{})]})]})}var Ge=Object(i.b)((function(e){var t=e.drawReducer;return{context:t.context,dispatch:t.dispatch}}))(O.a.memo(Be));n(69);var He=Object(i.b)((function(e){var t=e.drawReducer;return{tool:t.tool,isDraw:t.isDraw,color:t.color,dispatch:t.dispatch,size:t.size,img:t.img,context:t.context}}))((function(e){var t=e.tool,n=e.isDraw,a=e.color,r=e.size,c=e.dispatch,i=e.img,s=e.context,o=Object(d.useRef)(null),u=Object(d.useRef)(null),b=Object(d.useRef)(0),j=Object(d.useRef)(0),O=Object(d.useCallback)((function(){o&&o.current&&c($.setImg(ye.createImg(o.current))),ye.clearFromPaintbrush(),c($.stopDraw())}),[c]),f=Object(d.useCallback)((function(){o&&o.current&&u&&u.current&&(o.current.width=u.current.clientWidth,o.current.height=u.current.clientHeight,c($.setContext(ye.createContext(o.current))))}),[c]);return Object(d.useEffect)((function(){return o&&o.current&&(o.current.height=window.innerHeight,window.innerWidth<712&&(o.current.width=window.innerWidth-50),c($.setContext(ye.createContext(o.current)))),window.addEventListener("resize",f),function(){return window.removeEventListener("resize",f)}}),[c,f]),Object(d.useEffect)((function(){return document.addEventListener("mouseup",O),function(){return document.removeEventListener("mouseup",O)}}),[O]),Object(l.jsx)("div",{className:"mainview",ref:u,children:Object(l.jsx)("canvas",{className:"mainview__canvas",id:"mainview",ref:o,width:712,height:632,onMouseDown:function(e){var n=e.clientX,u=e.clientY;if(c($.hideSizeBar()),c($.hideShapeBar()),o&&o.current&&s&&t){c($.startDraw());var l=n-o.current.offsetLeft,d=u-o.current.offsetTop;t===V.PAINTBRUSH?ye.drawPoint(s,l,d,a,r,i):(b.current=l,j.current=d)}},onMouseMove:function(e){var c=e.clientX,u=e.clientY;if(o&&o.current&&s){var l=c-o.current.offsetLeft,d=u-o.current.offsetTop,O=l-b.current,f=d-j.current;if(n&&t===V.PAINTBRUSH)ye.drawPoint(s,l,d,a,r,i);else if(n&&t===V.LINE)ye.drawLine(s,r,a,b.current,j.current,l,d,i);else if(n&&t===V.CIRCLE)ye.drawCircle(s,b.current,j.current,O,f,a,i);else if(n&&t===V.RECTANGLE)ye.drawRectangle(s,b.current,j.current,O,f,a,i);else if(n&&t===V.STAR){var m=O+f;ye.drawStar(s,b.current,j.current,m,a,i)}else n&&t===V.HEXAGON&&ye.drawHexagon(s,b.current,j.current,O,a,i)}},onMouseUp:O,onMouseLeave:function(){t===V.PAINTBRUSH&&o&&o.current&&(c($.setImg(ye.createImg(o.current))),ye.clearFromPaintbrush())}})})}));function ze(){return Object(l.jsxs)("div",{className:"paint",children:[Object(l.jsx)(He,{}),Object(l.jsx)(Ge,{})]})}var Me,We=O.a.memo(ze),Xe=n(35);!function(e){e.SUCCESS_DOWNLOAD="SUCCESS_DOWNLOAD",e.FILTER_IMAGES="FILTER_IMAGES",e.SET_IMAGES="SET_IMAGES",e.SUCCESS_DOWNLOAD_USERS="SUCCESS_DOWNLOAD_USERS"}(Me||(Me={}));var Ze={getImages:function(){return function(e){k.onImages().then((function(t){e(function(e){return{type:Me.SUCCESS_DOWNLOAD,payload:e}}(t))}))}},filterImages:function(e){return{type:Me.FILTER_IMAGES,payload:e}},setImages:function(e){return{type:Me.SET_IMAGES,payload:e}},getUsers:function(){return function(e){k.onUsers().then((function(t){e(function(e){return{type:Me.SUCCESS_DOWNLOAD_USERS,payload:e}}(t))}))}}};n(70);function Ye(e){var t=e.images,n=e.filtredKey,a=Object(i.c)(),r=Object(d.useMemo)((function(){return function(e,t){var n=Object.values(e);return"all"!==t&&(n=n.filter((function(e){return e.uid===t}))),n.map((function(e,t,n){return Object(l.jsx)("li",{className:"gallery-list__item",id:t===n.length-1?"last":void 0,children:Object(l.jsx)("img",{src:e.image,alt:""})},e.image)}))}(t,n)}),[t,n]);return Object(d.useEffect)((function(){a(Ze.getImages()),a(Ze.getUsers())}),[a]),Object(d.useEffect)((function(){var e=document.querySelector("#last");e&&Object(Xe.a)(e,{block:"center",inline:"center"})})),Object(l.jsx)("ul",{className:"gallery-list",children:r})}var Ke=Object(i.b)((function(e){var t=e.showReducer;return{images:t.images,filtredKey:t.filtredKey}}))(O.a.memo(Ye)),Fe=(n(71),n(16)),qe={user:null,currentUserId:null};var Je={tool:null,isDraw:!1,color:"#000",isShowedSizeBar:!1,size:"5",isShowedShapeBar:!1,img:null,context:null,isClean:!0};var Ve={images:{},users:{},filtredImages:{},filtredKey:"all"};var Qe=Object(Fe.c)({authReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g.SUCCESS:return Object(o.a)(Object(o.a)({},e),{},{user:t.payload});case g.SIGNOUT:return qe;case g.SET_CURRENT_USER_ID:return Object(o.a)(Object(o.a)({},e),{},{currentUserId:t.payload});default:return e}},drawReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V.NO_TOOL:return Object(o.a)(Object(o.a)({},e),{},{tool:null});case V.PAINTBRUSH:return Object(o.a)(Object(o.a)({},e),{},{tool:V.PAINTBRUSH});case V.LINE:return Object(o.a)(Object(o.a)({},e),{},{tool:V.LINE});case V.RECTANGLE:return Object(o.a)(Object(o.a)({},e),{},{tool:V.RECTANGLE});case V.CIRCLE:return Object(o.a)(Object(o.a)({},e),{},{tool:V.CIRCLE});case V.STAR:return Object(o.a)(Object(o.a)({},e),{},{tool:V.STAR});case V.HEXAGON:return Object(o.a)(Object(o.a)({},e),{},{tool:V.HEXAGON});case V.START_DRAW:return Object(o.a)(Object(o.a)({},e),{},{isDraw:!0,isClean:!1});case V.STOP_DRAW:return Object(o.a)(Object(o.a)({},e),{},{isDraw:!1});case V.SET_COLOR:return Object(o.a)(Object(o.a)({},e),{},{color:t.payload});case V.SHOW_SIZE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedSizeBar:!0});case V.HIDE_SIZE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedSizeBar:!1});case V.SET_SIZE:return Object(o.a)(Object(o.a)({},e),{},{size:t.payload});case V.SHOW_SHAPE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedShapeBar:!0});case V.HIDE_SHAPE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedShapeBar:!1});case V.SET_IMG:return Object(o.a)(Object(o.a)({},e),{},{img:t.payload});case V.DELETE_IMG:return Object(o.a)(Object(o.a)({},e),{},{img:null});case V.SET_CONTEXT:return Object(o.a)(Object(o.a)({},e),{},{context:t.payload});case V.CLEAR:return Object(o.a)(Object(o.a)({},e),{},{isClean:!0});default:return e}},showReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Me.SUCCESS_DOWNLOAD:return Object(o.a)(Object(o.a)({},e),{},{images:Object(o.a)({},t.payload)});case Me.FILTER_IMAGES:return Object(o.a)(Object(o.a)({},e),{},{filtredKey:t.payload});case Me.SET_IMAGES:return Object(o.a)(Object(o.a)({},e),{},{filtredImages:Object(o.a)({},t.payload)});case Me.SUCCESS_DOWNLOAD_USERS:return Object(o.a)(Object(o.a)({},e),{},{users:Object(o.a)({},t.payload)});default:return e}}}),$e=n(33),et=Object(Fe.d)(Qe,Object(Fe.a)($e.a));n(72);function tt(e){var t=e.filtredKey,n=e.images,a=e.users,r=Object(d.useMemo)((function(){return function(e,t){var n=Object.values(e).filter((function(e){var n=e.uid;return t.hasOwnProperty(n)})).map((function(e){var n=e.uid;return t[n].email})),a=Object.entries(t).filter((function(e){return n.includes(e[1].email)}));return a.push(["all",{email:"all"}]),a.map((function(e){var t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(l.jsx)("option",{value:n,children:a.email},n)}))}(n,a)}),[n,a]);return Object(l.jsx)("select",{className:"filter",value:t,onChange:function(e){var t=e.target.value;et.dispatch(Ze.filterImages(t))},children:r})}var nt=Object(i.b)((function(e){var t=e.showReducer;return{filtredKey:t.filtredKey,images:t.images,users:t.users}}))(O.a.memo(tt));function at(){var e=Object(d.useCallback)((function(){T.push(a.PAINT)}),[]);return Object(l.jsxs)("div",{className:"gallery-toolbar",children:[Object(l.jsx)(Q,{}),Object(l.jsx)(nt,{}),Object(l.jsx)(K,{onClick:e,children:Object(l.jsx)("img",{src:re,alt:""})})]})}var rt=O.a.memo(at);n(73);function ct(){return Object(l.jsxs)("div",{className:"gallery",children:[Object(l.jsx)(rt,{}),Object(l.jsx)(Ke,{})]})}var it=O.a.memo(ct);n(74);var st=function(){return Object(l.jsx)("div",{className:"loader",children:"Loading..."})};var ot=function(e){var t=e.children,n=Object(i.c)(),a=Object(d.useState)(!0),r=Object(j.a)(a,2),c=r[0],o=r[1];return Object(d.useEffect)((function(){return N.onAuthStateChanged((function(e){if(e){var t=e.uid,a=e.email;n(G.success({email:a||"unknowk"})),n(G.setCurrentUserId(t))}o(!1)}))}),[n]),Object(l.jsx)(s.b,{children:c?Object(l.jsx)(st,{}):t})};var ut=function(){return Object(l.jsx)("div",{className:"main",children:Object(l.jsx)("div",{className:"container",children:Object(l.jsx)(s.c,{history:T,children:Object(l.jsx)(s.d,{children:Object(l.jsxs)(ot,{children:[Object(l.jsx)(b,{exact:!0,path:a.GALLERY,component:it}),Object(l.jsx)(b,{path:a.PAINT,component:We}),Object(l.jsx)(s.b,{path:a.SIGNIN,component:W}),Object(l.jsx)(s.b,{path:a.REGISTER,component:Z})]})})})})})};c.a.render(Object(l.jsx)(i.a,{store:et,children:Object(l.jsx)(ut,{})}),document.querySelector("#root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.272d7cba.chunk.js.map