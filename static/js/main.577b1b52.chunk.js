(this["webpackJsonpinnowise-lab-internship-level-2-mini-paint"]=this["webpackJsonpinnowise-lab-internship-level-2-mini-paint"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a,r=n(19),c=n.n(r),i=n(6),s=(n(44),n(45),n(31)),o=n(3),u=n(34);!function(e){e.SIGNIN="/signin",e.REGISTER="/register",e.GALLERY="/",e.PAINT="/paint"}(a||(a={}));var l=n(2);var b=Object(i.b)((function(e){return{user:e.authReducer.user}}))((function(e){var t=e.user,n=e.component,r=Object(u.a)(e,["user","component"]);return Object(l.jsx)(s.b,Object(o.a)(Object(o.a)({},r),{},{render:function(e){return t?Object(l.jsx)(n,Object(o.a)({},e)):Object(l.jsx)(s.a,{to:a.SIGNIN})}}))})),d=n(15),j=(n(48),n(1)),O=n.n(j);n(49);function f(e){var t=e.onSubmit,n=e.onChange,a=e.children;return Object(l.jsxs)("form",{className:"form",onSubmit:t,children:[Object(l.jsx)("input",{className:"form__email",type:"email",name:"email",placeholder:"email",onChange:n,required:!0}),Object(l.jsx)("input",{className:"form__password",type:"password",name:"password",placeholder:"password",onChange:n,required:!0}),a]})}var m=O.a.memo(f);n(50);function h(e){var t=e.value;return Object(l.jsx)("input",{className:"form-btn",type:"submit",value:t})}var p=O.a.memo(h);n(51);function v(e){var t=e.value,n=e.onClick;return Object(l.jsx)("button",{className:"modal-btn",onClick:n,children:t})}var S=O.a.memo(v);n(52);function E(e){var t=e.children,n=e.text,a=e.value,r=e.onClick;return Object(l.jsxs)("div",{className:"modal",children:[t,Object(l.jsxs)("div",{className:"modal__footer",children:[Object(l.jsx)("span",{className:"modal__text",children:n}),Object(l.jsx)(S,{value:a,onClick:r})]})]})}var g,R=O.a.memo(E);!function(e){e.SIGNOUT="SIGNOUT",e.REQUEST="REQUEST",e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.SET_CURRENT_USER_ID="SET_CURRENT_USER_ID"}(g||(g={}));var x=n(13),T=Object(x.a)(),C=n(32),_=(n(53),n(55),C.a.initializeApp({apiKey:"AIzaSyCAwELykffctQvVVslcPPXxa6gCbKD5znU",authDomain:"mini-paint-58a48.firebaseapp.com",databaseURL:"https://mini-paint-58a48-default-rtdb.firebaseio.com",projectId:"mini-paint-58a48",storageBucket:"mini-paint-58a48.appspot.com",messagingSenderId:"394339851119",appId:"1:394339851119:web:1dd455169d2dcde511269a"})),I=_.database(),N=_.auth(),w={signin:function(e,t){return N.signInWithEmailAndPassword(e,t)},register:function(e,t){return N.createUserWithEmailAndPassword(e,t)},signout:function(){return N.signOut()}};var A=n(7),y=n(9),L=n.n(y),P=n(17),k={sendImg:function(e,t){return U.apply(this,arguments)},onImages:function(){return D.apply(this,arguments)},onUsers:function(){return new Promise((function(e){I.ref().child("users").on("value",(function(t){var n=t.val();e(n||{})}))}))},setUserEmail:function(e,t){I.ref("users/".concat(e)).set({email:t.email})}};function U(){return(U=Object(P.a)(L.a.mark((function e(t,n){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.ref().child("images").push({image:t,uid:n});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(P.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){I.ref().child("images").on("value",(function(t){var n=t.val();e(n||{})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B,G={signin:function(e,t){return function(n){n(H()),w.signin(e,t).then((function(e){var t=e.user;if(t){var r=t.uid,c=t.email;n(z({email:c||"unknowk"})),n(W(r)),T.push(a.GALLERY)}})).catch((function(e){var t=e.message;n(M()),A.b.isActive(B)||(B=A.b.error(t,{position:A.b.POSITION.TOP_CENTER}))}))}},register:function(e,t){return function(n){n(H()),w.register(e,t).then((function(e){var t=e.user;if(t){var r=t.uid,c={email:t.email||"unknowk"};n(z(c)),n(W(r)),k.setUserEmail(r,c),T.push(a.GALLERY)}})).catch((function(e){var t=e.message;n(M()),A.b.isActive(B)||(B=A.b.error(t,{position:A.b.POSITION.TOP_CENTER}))}))}},signout:function(){return function(e){w.signout().then((function(){e({type:g.SIGNOUT})}))}}};function H(){return{type:g.REQUEST}}function z(e){return{type:g.SUCCESS,payload:e}}function M(){return{type:g.ERROR}}function W(e){return{type:g.SET_CURRENT_USER_ID,payload:e}}A.b.configure();n(59),n(60);var X=function(){return Object(l.jsx)("div",{className:"loader",children:"Loading..."})};function Z(e){var t=e.loading,n=Object(j.useState)(""),r=Object(d.a)(n,2),c=r[0],s=r[1],o=Object(j.useState)(""),u=Object(d.a)(o,2),b=u[0],O=u[1],f=Object(i.c)(),h=Object(j.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;"email"===n?s(a):"password"===n&&O(a)}),[]),v=Object(j.useCallback)((function(e){e.preventDefault(),f(G.signin(c,b))}),[c,b,f]),S=Object(j.useCallback)((function(){T.push(a.REGISTER)}),[]);return Object(l.jsxs)("div",{className:"signin",children:[t&&Object(l.jsx)(X,{}),Object(l.jsx)(A.a,{}),Object(l.jsx)(R,{text:"Need an account?",value:"register",onClick:S,children:Object(l.jsx)(m,{onChange:h,onSubmit:v,children:Object(l.jsx)(p,{value:"sign in"})})})]})}A.b.configure();var Y=Object(i.b)((function(e){return{loading:e.authReducer.loading}}))(O.a.memo(Z));n(61);function K(e){var t=e.loading,n=Object(j.useState)(""),r=Object(d.a)(n,2),c=r[0],s=r[1],o=Object(j.useState)(""),u=Object(d.a)(o,2),b=u[0],O=u[1],f=Object(j.useState)(""),h=Object(d.a)(f,2),v=h[0],S=h[1],E=Object(j.useRef)(""),g=Object(i.c)(),x=Object(j.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;"email"===n?s(a):"password"===n?O(a):"confirmation"===n&&S(a)}),[]),C=Object(j.useCallback)((function(e){e.preventDefault(),b===v?g(G.register(c,b)):A.b.isActive(E.current)||A.b.error("Passwords do not match",{position:A.b.POSITION.TOP_CENTER})}),[c,b,v,g]);return Object(l.jsxs)("div",{className:"register",children:[t&&Object(l.jsx)(X,{}),Object(l.jsx)(A.a,{}),Object(l.jsx)(R,{text:"Already have an account?",value:"sign in",onClick:function(){T.push(a.SIGNIN)},children:Object(l.jsxs)(m,{onChange:x,onSubmit:C,children:[Object(l.jsx)("input",{className:"confirmation",type:"password",name:"confirmation",placeholder:"confirm password",onChange:x}),Object(l.jsx)(p,{value:"register"})]})})]})}A.b.configure();var F=Object(i.b)((function(e){return{loading:e.authReducer.loading}}))(O.a.memo(K));n(62),n(63);function Q(e){var t=e.tool,n=e.isShowedSizeBar,a=e.name,r=e.children,c=e.isShowedShapeBar,i=e.onClick,s=Object(j.useMemo)((function(){var e="paint-btn";return(a===t||"size-bar"===a&&n||"shape-bar"===a&&c)&&(e+=" active"),e}),[a,t,c,n]);return Object(l.jsx)("button",{type:"button",className:s,name:a,onClick:i,children:r})}var q=Object(i.b)((function(e){var t=e.drawReducer;return{tool:t.tool,isShowedSizeBar:t.isShowedSizeBar,isShowedShapeBar:t.isShowedShapeBar}}))(O.a.memo(Q)),J=(n(64),n.p+"static/media/picture.082f3262.svg"),V=n.p+"static/media/logout.58dee8cf.svg";function $(){var e=Object(i.c)(),t=Object(j.useCallback)((function(){e(G.signout())}),[e]);return Object(l.jsx)(q,{onClick:t,children:Object(l.jsx)("img",{src:V,alt:""})})}var ee,te=O.a.memo($);!function(e){e.NO_TOOL="NO_TOOL",e.PAINTBRUSH="PAINTBRUSH",e.LINE="LINE",e.RECTANGLE="RECTANGLE",e.CIRCLE="CIRCLE",e.STAR="STAR",e.HEXAGON="HEXAGON",e.START_DRAW="STARTDRAW",e.STOP_DRAW="STOP_DRAW",e.SET_COLOR="SET_COLOR",e.SHOW_SIZE_BAR="SHOW_SIZE_BAR",e.HIDE_SIZE_BAR="HIDE_SIZE_BAR",e.SET_SIZE="SET_SIZE",e.SHOW_SHAPE_BAR="SHOW_SHAPE_BAR",e.HIDE_SHAPE_BAR="HIDE_SHAPE_BAR",e.SET_IMG="SET_IMG",e.DELETE_IMG="DELETE_IMG",e.SET_CONTEXT="SET_CONTEXT",e.CLEAR="CLEAR"}(ee||(ee={}));var ne={noTool:function(){return{type:ee.NO_TOOL}},paintbrush:function(){return{type:ee.PAINTBRUSH}},startDraw:function(){return{type:ee.START_DRAW}},stopDraw:function(){return{type:ee.STOP_DRAW}},setColor:function(e){return{type:ee.SET_COLOR,payload:e}},showSizeBar:function(){return{type:ee.SHOW_SIZE_BAR}},hideSizeBar:function(){return{type:ee.HIDE_SIZE_BAR}},setSize:function(e){return{type:ee.SET_SIZE,payload:e}},showShapeBar:function(){return{type:ee.SHOW_SHAPE_BAR}},hideShapeBar:function(){return{type:ee.HIDE_SHAPE_BAR}},line:function(){return{type:ee.LINE}},rectangle:function(){return{type:ee.RECTANGLE}},circle:function(){return{type:ee.CIRCLE}},star:function(){return{type:ee.STAR}},hexagon:function(){return{type:ee.HEXAGON}},setImg:function(e){return{type:ee.SET_IMG,payload:e}},deleteImg:function(){return{type:ee.DELETE_IMG}},setContext:function(e){return{type:ee.SET_CONTEXT,payload:e}},clear:function(){return{type:ee.CLEAR}}};function ae(e){var t=e.dispatch,n=(e.img,Object(j.useCallback)(Object(P.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(ne.deleteImg()),t(ne.clear()),T.push(a.GALLERY);case 3:case"end":return e.stop()}}),e)}))),[t]));return Object(l.jsxs)("ul",{className:"navbar",children:[Object(l.jsx)("li",{className:"navbar__item",children:Object(l.jsx)(te,{})}),Object(l.jsx)("li",{className:"navbar__item",children:Object(l.jsx)(q,{onClick:n,children:Object(l.jsx)("img",{src:J,alt:""})})})]})}var re=Object(i.b)((function(e){var t=e.drawReducer,n=t.img;return{dispatch:t.dispatch,img:n}}))(O.a.memo(ae));n(65);function ce(e){var t=e.dispatch,n=e.color;return Object(l.jsx)("input",{className:"color-input",value:n,type:"color",name:"color",onChange:function(e){var n=e.target.value;t(ne.setColor(n))}})}var ie=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,color:t.color}}))(O.a.memo(ce)),se=n.p+"static/media/pencil.d161d2e9.svg";function oe(e){var t=e.dispatch,n=e.tool,a=Object(j.useCallback)((function(){n===ee.PAINTBRUSH?t(ne.noTool()):t(ne.paintbrush())}),[t,n]);return Object(l.jsx)(q,{name:ee.PAINTBRUSH,onClick:a,children:Object(l.jsx)("img",{src:se,alt:""})})}var ue=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(oe)),le=n.p+"static/media/circle.dddf140d.svg";function be(e){var t=e.dispatch,n=e.tool,a=Object(j.useCallback)((function(){n===ee.CIRCLE?t(ne.noTool()):t(ne.circle())}),[n,t]);return Object(l.jsx)(q,{name:ee.CIRCLE,onClick:a,children:Object(l.jsx)("img",{src:le,alt:"circle"})})}var de=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(be)),je=n.p+"static/media/line.71e38afd.svg";function Oe(e){var t=e.dispatch,n=e.tool,a=Object(j.useCallback)((function(){n===ee.LINE?t(ne.noTool()):t(ne.line())}),[n,t]);return Object(l.jsx)(q,{name:ee.LINE,onClick:a,children:Object(l.jsx)("img",{src:je,alt:"line"})})}var fe=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(Oe)),me=n.p+"static/media/hexagon.5fee026a.svg";function he(e){var t=e.dispatch,n=e.tool,a=Object(j.useCallback)((function(){n===ee.HEXAGON?t(ne.noTool()):t(ne.hexagon())}),[n,t]);return Object(l.jsx)(q,{name:ee.HEXAGON,onClick:a,children:Object(l.jsx)("img",{src:me,alt:"hexagon"})})}var pe=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(he)),ve=n.p+"static/media/rectangle.19aa566b.svg";function Se(e){var t=e.dispatch,n=e.tool,a=Object(j.useCallback)((function(){n===ee.RECTANGLE?t(ne.noTool()):t(ne.rectangle())}),[n,t]);return Object(l.jsx)(q,{name:ee.RECTANGLE,onClick:a,children:Object(l.jsx)("img",{src:ve,alt:"rectangle"})})}var Ee=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(Se)),ge=n.p+"static/media/star.103f4316.svg";function Re(e){var t=e.dispatch,n=e.tool,a=Object(j.useCallback)((function(){n===ee.STAR?t(ne.noTool()):t(ne.star())}),[n,t]);return Object(l.jsx)(q,{name:ee.STAR,onClick:a,children:Object(l.jsx)("img",{src:ge,alt:"star"})})}var xe=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,tool:t.tool}}))(O.a.memo(Re)),Te=(n(66),n.p+"static/media/points.ce4d7f60.svg");var Ce=Object(i.b)((function(e){var t=e.drawReducer;return{dispatch:t.dispatch,isShowedShapeBar:t.isShowedShapeBar}}))((function(e){var t=e.dispatch,n=e.isShowedShapeBar,a=Object(j.useCallback)((function(){t(n?ne.hideShapeBar():ne.showShapeBar())}),[n,t]);return Object(l.jsxs)("div",{className:"shape-bar",children:[Object(l.jsx)(q,{name:"shape-bar",onClick:a,children:Object(l.jsx)("img",{src:Te,alt:""})}),n&&Object(l.jsxs)("ul",{className:"shape-bar__setting",children:[Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(fe,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(de,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(Ee,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(xe,{})}),Object(l.jsx)("li",{className:"shape-bar__item",children:Object(l.jsx)(pe,{})})]})]})}));n(67);var _e=Object(i.b)((function(e){var t=e.drawReducer;return{isShowedSizeBar:t.isShowedSizeBar,size:t.size,dispatch:t.dispatch}}))((function(e){var t=e.isShowedSizeBar,n=e.size,a=e.dispatch,r=Object(j.useCallback)((function(){a(t?ne.hideSizeBar():ne.showSizeBar())}),[t,a]);return Object(l.jsxs)("div",{className:"size-bar",children:[Object(l.jsx)(q,{name:"size-bar",onClick:r,children:"size"}),t&&Object(l.jsxs)("div",{className:"size-bar__setting",children:[Object(l.jsx)("input",{type:"range",name:"range",min:"1",max:"50",value:n,onChange:function(e){var t=e.target.value;a(ne.setSize(t))}}),Object(l.jsx)("span",{children:n})]})]})}));n(68);function Ie(){return Object(l.jsxs)("ul",{className:"drawbar",children:[Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(ue,{})}),Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(Ce,{})}),Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(_e,{})}),Object(l.jsx)("li",{className:"drawbar__item",children:Object(l.jsx)(ie,{})})]})}var Ne,we=O.a.memo(Ie),Ae=n.p+"static/media/disk.4e36d248.svg";function ye(e){var t=e.img,n=e.isClean,a=e.currentUserId,r=Object(j.useRef)(""),c=Object(j.useCallback)(Object(P.a)(L.a.mark((function e(){var c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}A.b.isActive(Ne)||(Ne=A.b.error("Error: the template is clean",{position:A.b.POSITION.TOP_CENTER})),e.next=18;break;case 4:if(r.current!==t.src){e.next=8;break}A.b.isActive(Ne)||(Ne=A.b.error("Error: this image is already saved",{position:A.b.POSITION.TOP_CENTER})),e.next=18;break;case 8:return e.prev=8,e.next=11,k.sendImg(t.src,a);case 11:A.b.info("image saved",{position:A.b.POSITION.TOP_CENTER}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),c=e.t0.message,A.b.error(c,{position:A.b.POSITION.TOP_CENTER});case 18:r.current=t.src;case 19:case"end":return e.stop()}}),e,null,[[8,14]])}))),[n,t,a]);return Object(l.jsxs)("div",{children:[Object(l.jsx)(A.a,{}),Object(l.jsx)(q,{onClick:c,children:Object(l.jsx)("img",{src:Ae,alt:""})})]})}A.b.configure();var Le=Object(i.b)((function(e){var t=e.drawReducer;return{img:t.img,isClean:t.isClean,currentUserId:e.authReducer.currentUserId}}))(O.a.memo(ye)),Pe=[],ke={redraw:Ue,addPoint:De,clearFromPaintbrush:function(){Pe.splice(0,Pe.length)},clearCanvas:Be,drawPoint:function(e,t,n,a,r,c){De(t,n,!0,a,r),Ue(e),Ge(e,c)},drawLine:function(e,t,n,a,r,c,i,s){Ue(e),e.lineWidth=+t,e.strokeStyle=n,e.beginPath(),e.moveTo(a,r),e.lineTo(c,i),e.closePath(),e.stroke(),Ge(e,s)},drawCircle:function(e,t,n,a,r,c,i){var s=.5522848,o=a/2*s,u=r/2*s,l=t+a,b=n+r,d=t+a/2,j=n+r/2;Ue(e),e.fillStyle=c,e.beginPath(),e.moveTo(t,j),e.bezierCurveTo(t,j-u,d-o,n,d,n),e.bezierCurveTo(d+o,n,l,j-u,l,j),e.bezierCurveTo(l,j+u,d+o,b,d,b),e.bezierCurveTo(d-o,b,t,j+u,t,j),e.closePath(),e.fill(),Ge(e,i)},drawRectangle:function(e,t,n,a,r,c,i){Ue(e),e.fillStyle=c,e.beginPath(),e.fillRect(t,n,a,r),e.closePath(),Ge(e,i)},drawImage:Ge,createImg:function(e){var t=e.toDataURL("image/png"),n=new Image;return n.src=t,n},drawStar:function(e,t,n,a,r,c){var i=Math.PI/5,s=Math.PI/2*3,o=t,u=n;Ue(e),e.fillStyle=r,e.beginPath(),e.moveTo(t,n-a),new Array(5).fill(null).forEach((function(){o=t+Math.cos(s)*a,u=n+Math.sin(s)*a,e.lineTo(o,u),s+=i,o=t+Math.cos(s)*(a/2),u=n+Math.sin(s)*(a/2),e.lineTo(o,u),s+=i})),e.lineTo(t,n-a),e.closePath(),e.fill(),Ge(e,c)},drawHexagon:function(e,t,n,a,r,c){var i=.523598776,s=Math.sin(i)*a,o=Math.cos(i)*a,u=2*o,l=a+2*s;Ue(e),e.fillStyle=r,e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+u,n+s),e.lineTo(t+u,n+s+a),e.lineTo(t+o,n+l),e.lineTo(t,n+a+s),e.lineTo(t,n+s),e.closePath(),e.fill(),Ge(e,c)},createContext:function(e){var t=e.getContext("2d");t&&(t.globalCompositeOperation="destination-over");return t}};function Ue(e){Be(e),e.lineJoin="round",Pe.forEach((function(t,n,a){e.beginPath(),t.drag&&n?e.moveTo(a[n-1].pointX,a[n-1].pointY):e.moveTo(t.pointX-1,t.pointY),e.lineTo(t.pointX,t.pointY),e.closePath(),e.strokeStyle=t.color,e.lineWidth=+t.size,e.stroke()}))}function De(e,t,n,a,r){Pe.push({pointX:e,pointY:t,drag:n,color:a,size:r})}function Be(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}function Ge(e,t){t&&e.drawImage(t,0,0)}n(69);var He=n.p+"static/media/trash.2d44fa45.svg";function ze(e){var t=e.context,n=e.dispatch,a=Object(j.useCallback)((function(){n(ne.deleteImg()),t&&(ke.clearCanvas(t),n(ne.clear()))}),[n,t]);return Object(l.jsxs)("div",{className:"paint-toolbar",children:[Object(l.jsx)(re,{}),Object(l.jsx)(we,{}),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{className:"clear-btn",children:Object(l.jsx)(q,{onClick:a,children:Object(l.jsx)("img",{src:He,alt:""})})}),Object(l.jsx)(Le,{})]})]})}var Me=Object(i.b)((function(e){var t=e.drawReducer;return{context:t.context,dispatch:t.dispatch}}))(O.a.memo(ze));n(70);var We=Object(i.b)((function(e){var t=e.drawReducer;return{tool:t.tool,isDraw:t.isDraw,color:t.color,dispatch:t.dispatch,size:t.size,img:t.img,context:t.context}}))((function(e){var t=e.tool,n=e.isDraw,a=e.color,r=e.size,c=e.dispatch,i=e.img,s=e.context,o=Object(j.useRef)(null),u=Object(j.useRef)(null),b=Object(j.useRef)(0),d=Object(j.useRef)(0),O=Object(j.useCallback)((function(){o&&o.current&&c(ne.setImg(ke.createImg(o.current))),ke.clearFromPaintbrush(),c(ne.stopDraw())}),[c]),f=Object(j.useCallback)((function(){o&&o.current&&u&&u.current&&(o.current.width=u.current.clientWidth,o.current.height=u.current.clientHeight,c(ne.setContext(ke.createContext(o.current))))}),[c]);return Object(j.useEffect)((function(){return o&&o.current&&(o.current.height=window.innerHeight,window.innerWidth<712&&(o.current.width=window.innerWidth-50),c(ne.setContext(ke.createContext(o.current)))),window.addEventListener("resize",f),function(){return window.removeEventListener("resize",f)}}),[c,f]),Object(j.useEffect)((function(){return document.addEventListener("mouseup",O),function(){return document.removeEventListener("mouseup",O)}}),[O]),Object(l.jsx)("div",{className:"mainview",ref:u,children:Object(l.jsx)("canvas",{className:"mainview__canvas",id:"mainview",ref:o,width:712,height:632,onMouseDown:function(e){var n=e.clientX,u=e.clientY;if(c(ne.hideSizeBar()),c(ne.hideShapeBar()),o&&o.current&&s&&t){c(ne.startDraw());var l=n-o.current.offsetLeft,j=u-o.current.offsetTop;t===ee.PAINTBRUSH?ke.drawPoint(s,l,j,a,r,i):(b.current=l,d.current=j)}},onMouseMove:function(e){var c=e.clientX,u=e.clientY;if(o&&o.current&&s){var l=c-o.current.offsetLeft,j=u-o.current.offsetTop,O=l-b.current,f=j-d.current;if(n&&t===ee.PAINTBRUSH)ke.drawPoint(s,l,j,a,r,i);else if(n&&t===ee.LINE)ke.drawLine(s,r,a,b.current,d.current,l,j,i);else if(n&&t===ee.CIRCLE)ke.drawCircle(s,b.current,d.current,O,f,a,i);else if(n&&t===ee.RECTANGLE)ke.drawRectangle(s,b.current,d.current,O,f,a,i);else if(n&&t===ee.STAR){var m=O+f;ke.drawStar(s,b.current,d.current,m,a,i)}else n&&t===ee.HEXAGON&&ke.drawHexagon(s,b.current,d.current,O,a,i)}},onMouseUp:O,onMouseLeave:function(){t===ee.PAINTBRUSH&&o&&o.current&&(c(ne.setImg(ke.createImg(o.current))),ke.clearFromPaintbrush())}})})}));function Xe(){return Object(l.jsxs)("div",{className:"paint",children:[Object(l.jsx)(We,{}),Object(l.jsx)(Me,{})]})}var Ze,Ye=O.a.memo(Xe),Ke=n(35);!function(e){e.SUCCESS_DOWNLOAD="SUCCESS_DOWNLOAD",e.FILTER_IMAGES="FILTER_IMAGES",e.SET_IMAGES="SET_IMAGES",e.SUCCESS_DOWNLOAD_USERS="SUCCESS_DOWNLOAD_USERS"}(Ze||(Ze={}));var Fe={getImages:function(){return function(e){k.onImages().then((function(t){e(function(e){return{type:Ze.SUCCESS_DOWNLOAD,payload:e}}(t))}))}},filterImages:function(e){return{type:Ze.FILTER_IMAGES,payload:e}},setImages:function(e){return{type:Ze.SET_IMAGES,payload:e}},getUsers:function(){return function(e){k.onUsers().then((function(t){e(function(e){return{type:Ze.SUCCESS_DOWNLOAD_USERS,payload:e}}(t))}))}}};n(71);function Qe(e){var t=e.images,n=e.filtredKey,a=Object(i.c)(),r=Object(j.useMemo)((function(){return function(e,t){var n=Object.values(e);return"all"!==t&&(n=n.filter((function(e){return e.uid===t}))),n.map((function(e,t,n){return Object(l.jsx)("li",{className:"gallery-list__item",id:t===n.length-1?"last":void 0,children:Object(l.jsx)("img",{src:e.image,alt:""})},e.image)}))}(t,n)}),[t,n]);return Object(j.useEffect)((function(){a(Fe.getImages()),a(Fe.getUsers())}),[a]),Object(j.useEffect)((function(){var e=document.querySelector("#last");e&&Object(Ke.a)(e,{block:"center",inline:"center"})})),Object(l.jsx)("ul",{className:"gallery-list",children:r})}var qe=Object(i.b)((function(e){var t=e.showReducer;return{images:t.images,filtredKey:t.filtredKey}}))(O.a.memo(Qe)),Je=(n(72),n(16)),Ve={loading:!1,user:null,currentUserId:null};var $e={tool:null,isDraw:!1,color:"#000",isShowedSizeBar:!1,size:"5",isShowedShapeBar:!1,img:null,context:null,isClean:!0};var et={images:{},users:{},filtredImages:{},filtredKey:"all"};var tt=Object(Je.c)({authReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g.REQUEST:return Object(o.a)(Object(o.a)({},e),{},{loading:!0});case g.SUCCESS:return Object(o.a)(Object(o.a)({},e),{},{loading:!1,user:t.payload});case g.ERROR:return Object(o.a)(Object(o.a)({},e),{},{loading:!1});case g.SIGNOUT:return Ve;case g.SET_CURRENT_USER_ID:return Object(o.a)(Object(o.a)({},e),{},{currentUserId:t.payload});default:return e}},drawReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee.NO_TOOL:return Object(o.a)(Object(o.a)({},e),{},{tool:null});case ee.PAINTBRUSH:return Object(o.a)(Object(o.a)({},e),{},{tool:ee.PAINTBRUSH});case ee.LINE:return Object(o.a)(Object(o.a)({},e),{},{tool:ee.LINE});case ee.RECTANGLE:return Object(o.a)(Object(o.a)({},e),{},{tool:ee.RECTANGLE});case ee.CIRCLE:return Object(o.a)(Object(o.a)({},e),{},{tool:ee.CIRCLE});case ee.STAR:return Object(o.a)(Object(o.a)({},e),{},{tool:ee.STAR});case ee.HEXAGON:return Object(o.a)(Object(o.a)({},e),{},{tool:ee.HEXAGON});case ee.START_DRAW:return Object(o.a)(Object(o.a)({},e),{},{isDraw:!0,isClean:!1});case ee.STOP_DRAW:return Object(o.a)(Object(o.a)({},e),{},{isDraw:!1});case ee.SET_COLOR:return Object(o.a)(Object(o.a)({},e),{},{color:t.payload});case ee.SHOW_SIZE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedSizeBar:!0});case ee.HIDE_SIZE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedSizeBar:!1});case ee.SET_SIZE:return Object(o.a)(Object(o.a)({},e),{},{size:t.payload});case ee.SHOW_SHAPE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedShapeBar:!0});case ee.HIDE_SHAPE_BAR:return Object(o.a)(Object(o.a)({},e),{},{isShowedShapeBar:!1});case ee.SET_IMG:return Object(o.a)(Object(o.a)({},e),{},{img:t.payload});case ee.DELETE_IMG:return Object(o.a)(Object(o.a)({},e),{},{img:null});case ee.SET_CONTEXT:return Object(o.a)(Object(o.a)({},e),{},{context:t.payload});case ee.CLEAR:return Object(o.a)(Object(o.a)({},e),{},{isClean:!0});default:return e}},showReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ze.SUCCESS_DOWNLOAD:return Object(o.a)(Object(o.a)({},e),{},{images:Object(o.a)({},t.payload)});case Ze.FILTER_IMAGES:return Object(o.a)(Object(o.a)({},e),{},{filtredKey:t.payload});case Ze.SET_IMAGES:return Object(o.a)(Object(o.a)({},e),{},{filtredImages:Object(o.a)({},t.payload)});case Ze.SUCCESS_DOWNLOAD_USERS:return Object(o.a)(Object(o.a)({},e),{},{users:Object(o.a)({},t.payload)});default:return e}}}),nt=n(33),at=Object(Je.d)(tt,Object(Je.a)(nt.a));n(73);function rt(e){var t=e.filtredKey,n=e.images,a=e.users,r=Object(j.useMemo)((function(){return function(e,t){var n=Object.values(e).filter((function(e){var n=e.uid;return t.hasOwnProperty(n)})).map((function(e){var n=e.uid;return t[n].email})),a=Object.entries(t).filter((function(e){return n.includes(e[1].email)}));return a.push(["all",{email:"all"}]),a.map((function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return Object(l.jsx)("option",{value:n,children:a.email},n)}))}(n,a)}),[n,a]);return Object(l.jsx)("select",{className:"filter",value:t,onChange:function(e){var t=e.target.value;at.dispatch(Fe.filterImages(t))},children:r})}var ct=Object(i.b)((function(e){var t=e.showReducer;return{filtredKey:t.filtredKey,images:t.images,users:t.users}}))(O.a.memo(rt));function it(){var e=Object(j.useCallback)((function(){T.push(a.PAINT)}),[]);return Object(l.jsxs)("div",{className:"gallery-toolbar",children:[Object(l.jsx)(te,{}),Object(l.jsx)(ct,{}),Object(l.jsx)(q,{onClick:e,children:Object(l.jsx)("img",{src:se,alt:""})})]})}var st=O.a.memo(it);n(74);function ot(){return Object(l.jsxs)("div",{className:"gallery",children:[Object(l.jsx)(st,{}),Object(l.jsx)(qe,{})]})}var ut=O.a.memo(ot);var lt=function(){return Object(l.jsx)("div",{className:"main",children:Object(l.jsx)("div",{className:"container",children:Object(l.jsx)(s.c,{history:T,children:Object(l.jsxs)(s.d,{children:[Object(l.jsx)(b,{exact:!0,path:a.GALLERY,component:ut}),Object(l.jsx)(b,{path:a.PAINT,component:Ye}),Object(l.jsx)(s.b,{path:a.SIGNIN,component:Y}),Object(l.jsx)(s.b,{path:a.REGISTER,component:F})]})})})})};c.a.render(Object(l.jsx)(i.a,{store:at,children:Object(l.jsx)(lt,{})}),document.querySelector("#root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.577b1b52.chunk.js.map